<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Society Management System</title>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}

.page {
    display: none;
}

.page.active {
    display: block;
}

/* Login Page */
.login-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    padding: 20px;
}

.login-header {
    text-align: center;
    color: white;
    margin-bottom: 30px;
}

.login-header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
}

.login-box {
    background: white;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    width: 100%;
    max-width: 400px;
}

.login-box h2 {
    margin-bottom: 25px;
    color: #333;
    text-align: center;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    margin-bottom: 8px;
    color: #555;
    font-weight: 500;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 14px;
    transition: border-color 0.3s;
    font-family: inherit;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
    outline: none;
    border-color: #667eea;
}

.btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.3s;
}

.btn-primary {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    width: 100%;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
}

.btn-logout {
    background: #ff4757;
    color: white;
    padding: 8px 16px;
}

.btn-logout:hover {
    background: #ff3838;
}

.login-info {
    margin-top: 20px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
    font-size: 12px;
    color: #666;
}

.login-info p {
    margin: 5px 0;
}

/* Navbar */
.navbar {
    background: white;
    padding: 15px 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.nav-brand {
    font-size: 1.5rem;
    font-weight: bold;
    color: #667eea;
}

.nav-user {
    display: flex;
    align-items: center;
    gap: 15px;
}

.nav-user span {
    font-weight: 500;
    color: #333;
}

/* Dashboard */
.dashboard {
    display: flex;
    min-height: calc(100vh - 70px);
}

.sidebar {
    width: 250px;
    background: white;
    padding: 20px 0;
    box-shadow: 2px 0 10px rgba(0,0,0,0.05);
}

.menu {
    list-style: none;
}

.menu li {
    margin: 5px 0;
}

.menu a {
    display: block;
    padding: 15px 25px;
    color: #666;
    text-decoration: none;
    transition: all 0.3s;
    font-weight: 500;
}

.menu a:hover,
.menu a.active {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-left: 4px solid #764ba2;
}

.content {
    flex: 1;
    padding: 30px;
    background: #f5f6fa;
    overflow-y: auto;
}

.section {
    display: none;
}

.section.active {
    display: block;
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    flex-wrap: wrap;
    gap: 15px;
}

.section-header h2 {
    color: #333;
    font-size: 1.8rem;
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    text-align: center;
    transition: transform 0.3s;
}

.stat-card:hover {
    transform: translateY(-5px);
}

.stat-card h3 {
    font-size: 2rem;
    color: #667eea;
    margin-bottom: 10px;
}

.stat-card.success h3 {
    color: #2ecc71;
}

.stat-card.danger h3 {
    color: #e74c3c;
}

.stat-card p {
    color: #666;
    font-size: 0.9rem;
}

/* Table */
.table-container {
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
    min-width: 600px;
}

thead {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
}

thead th {
    padding: 15px;
    text-align: left;
    font-weight: 600;
}

tbody tr {
    border-bottom: 1px solid #f0f0f0;
    transition: background 0.3s;
}

tbody tr:hover {
    background: #f8f9fa;
}

tbody td {
    padding: 15px;
    color: #333;
}

.badge {
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    display: inline-block;
}

.badge-active {
    background: #d4edda;
    color: #155724;
}

.badge-inactive {
    background: #f8d7da;
    color: #721c24;
}

.badge-upcoming {
    background: #d1ecf1;
    color: #0c5460;
}

.badge-completed {
    background: #d4edda;
    color: #155724;
}

.badge-cancelled {
    background: #f8d7da;
    color: #721c24;
}

.badge-income {
    background: #d4edda;
    color: #155724;
}

.badge-expense {
    background: #f8d7da;
    color: #721c24;
}

.action-btn {
    padding: 6px 12px;
    margin: 0 3px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 12px;
    transition: all 0.3s;
}

.btn-edit {
    background: #3498db;
    color: white;
}

.btn-edit:hover {
    background: #2980b9;
}

.btn-delete {
    background: #e74c3c;
    color: white;
}

.btn-delete:hover {
    background: #c0392b;
}

.btn-join {
    background: #2ecc71;
    color: white;
}

.btn-join:hover {
    background: #27ae60;
}

/* Profile Card */
.profile-card {
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    display: flex;
    align-items: center;
    gap: 25px;
    margin-bottom: 30px;
    flex-wrap: wrap;
}

.profile-avatar {
    width: 100px;
    height: 100px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    flex-shrink: 0;
}

.profile-info h3 {
    color: #333;
    margin-bottom: 8px;
}

.profile-info p {
    color: #666;
    margin: 5px 0;
}

/* Activities Grid */
.activities-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.activity-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    transition: transform 0.3s;
}

.activity-card:hover {
    transform: translateY(-5px);
}

.activity-card h3 {
    color: #333;
    margin-bottom: 10px;
}

.activity-card p {
    color: #666;
    margin: 8px 0;
    font-size: 0.9rem;
}

.activity-card button {
    margin-top: 15px;
    width: 100%;
}

/* Report Content */
.report-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
}

.report-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

.report-card h3 {
    color: #333;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #667eea;
}

.report-item {
    padding: 12px 0;
    border-bottom: 1px solid #f0f0f0;
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.report-item:last-child {
    border-bottom: none;
}

.report-item span:first-child {
    color: #666;
}

.report-item span:last-child {
    font-weight: 600;
    color: #333;
}

/* Report Form Container */
.report-form-container {
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    max-width: 800px;
}

/* Reports Container */
.reports-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 20px;
}

.user-report-card {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    transition: transform 0.3s;
}

.user-report-card:hover {
    transform: translateY(-5px);
}

.user-report-card h4 {
    color: #667eea;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 2px solid #f0f0f0;
}

.user-report-card .report-meta {
    display: flex;
    justify-content: space-between;
    margin-bottom: 15px;
    font-size: 0.9rem;
    color: #666;
}

.user-report-card .report-section {
    margin: 15px 0;
}

.user-report-card .report-section strong {
    display: block;
    color: #333;
    margin-bottom: 5px;
}

.user-report-card .report-section p {
    color: #666;
    line-height: 1.6;
}

/* Modal */
.modal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    animation: fadeIn 0.3s;
    overflow-y: auto;
}

.modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal-content {
    background: white;
    padding: 30px;
    border-radius: 15px;
    width: 90%;
    max-width: 500px;
    max-height: 90vh;
    overflow-y: auto;
    animation: slideUp 0.3s;
}

.close {
    float: right;
    font-size: 28px;
    font-weight: bold;
    color: #999;
    cursor: pointer;
    transition: color 0.3s;
    line-height: 1;
}

.close:hover {
    color: #333;
}

.modal-content h2 {
    margin-bottom: 25px;
    color: #333;
    clear: both;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideUp {
    from {
        transform: translateY(50px);
        opacity: 0;
    }
    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Responsive */
@media (max-width: 768px) {
    .dashboard {
        flex-direction: column;
    }
    
    .sidebar {
        width: 100%;
    }
    
    .menu {
        display: flex;
        overflow-x: auto;
        padding: 0 10px;
    }
    
    .menu li {
        margin: 0;
    }
    
    .menu a {
        white-space: nowrap;
        padding: 12px 20px;
    }
    
    .stats-grid,
    .activities-grid,
    .report-content,
    .reports-container {
        grid-template-columns: 1fr;
    }
    
    .section-header {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .section-header button {
        width: 100%;
    }
    
    .profile-card {
        flex-direction: column;
        text-align: center;
    }
    
    .navbar {
        padding: 15px;
    }
    
    .nav-brand {
        font-size: 1.2rem;
    }
    
    .content {
        padding: 15px;
    }
}
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="page active">
        <div class="login-container">
            <div class="login-header">
                <h1>üéì Student Society Portal</h1>
                <p>Manage your society efficiently</p>
            </div>
            <div class="login-box">
                <h2>Login</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label>Select Role</label>
                        <select id="roleSelect" required>
                            <option value="">Choose Role</option>
                            <option value="admin">Admin</option>
                            <option value="user">User</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" id="username" placeholder="Enter username" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" id="password" placeholder="Enter password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login</button>
                </form>
                <div class="login-info">
                    <p><strong>Demo Credentials:</strong></p>
                    <p>Admin: admin / admin123</p>
                    <p>User: user / user123</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminPage" class="page">
        <nav class="navbar">
            <div class="nav-brand">üéì Society Admin</div>
            <div class="nav-user">
                <span id="adminName">Admin</span>
                <button onclick="logout()" class="btn btn-logout">Logout</button>
            </div>
        </nav>
        
        <div class="dashboard">
            <aside class="sidebar">
                <ul class="menu">
                    <li><a href="#" onclick="showAdminSection('members')" class="active">üë• Members</a></li>
                    <li><a href="#" onclick="showAdminSection('activities')">üìÖ Activities</a></li>
                    <li><a href="#" onclick="showAdminSection('finance')">üí∞ Finance</a></li>
                    <li><a href="#" onclick="showAdminSection('reports')">üìä Reports</a></li>
                    <li><a href="#" onclick="showAdminSection('userReports')">üìù User Reports</a></li>
                </ul>
            </aside>
            
            <main class="content">
                <!-- Members Section -->
                <div id="membersSection" class="section active">
                    <div class="section-header">
                        <h2>Member Management</h2>
                        <button onclick="showAddMemberModal()" class="btn btn-primary">+ Add Member</button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="totalMembers">0</h3>
                            <p>Total Members</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="activeMembers">0</h3>
                            <p>Active Members</p>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="membersTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Role</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="membersTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Activities Section -->
                <div id="activitiesSection" class="section">
                    <div class="section-header">
                        <h2>Activities Management</h2>
                        <button onclick="showAddActivityModal()" class="btn btn-primary">+ Add Activity</button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="totalActivities">0</h3>
                            <p>Total Activities</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="upcomingActivities">0</h3>
                            <p>Upcoming</p>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="activitiesTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Activity Name</th>
                                    <th>Date</th>
                                    <th>Participants</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="activitiesTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Finance Section -->
                <div id="financeSection" class="section">
                    <div class="section-header">
                        <h2>Finance Management</h2>
                        <button onclick="showAddTransactionModal()" class="btn btn-primary">+ Add Transaction</button>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card success">
                            <h3 id="totalIncome">$0</h3>
                            <p>Total Income</p>
                        </div>
                        <div class="stat-card danger">
                            <h3 id="totalExpense">$0</h3>
                            <p>Total Expense</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="balance">$0</h3>
                            <p>Balance</p>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="financeTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="financeTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- Reports Section -->
                <div id="reportsSection" class="section">
                    <div class="section-header">
                        <h2>Reports & Analytics</h2>
                        <button onclick="generateReport()" class="btn btn-primary">Generate Report</button>
                    </div>
                    <div id="reportContent" class="report-content">
                        <div class="report-card">
                            <h3>Member Activity Report</h3>
                            <div id="memberActivityReport"></div>
                        </div>
                        <div class="report-card">
                            <h3>Financial Summary</h3>
                            <div id="financialReport"></div>
                        </div>
                    </div>
                </div>

                <!-- User Reports Section -->
                <div id="userReportsSection" class="section">
                    <div class="section-header">
                        <h2>User Monthly Reports</h2>
                    </div>
                    <div id="userReportsContainer" class="reports-container"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- User Dashboard -->
    <div id="userPage" class="page">
        <nav class="navbar">
            <div class="nav-brand">üéì My Society Portal</div>
            <div class="nav-user">
                <span id="userName">User</span>
                <button onclick="logout()" class="btn btn-logout">Logout</button>
            </div>
        </nav>
        
        <div class="dashboard">
            <aside class="sidebar">
                <ul class="menu">
                    <li><a href="#" onclick="showUserSection('profile')" class="active">üë§ My Profile</a></li>
                    <li><a href="#" onclick="showUserSection('myActivities')">üìÖ My Activities</a></li>
                    <li><a href="#" onclick="showUserSection('participation')">‚úÖ Participation</a></li>
                    <li><a href="#" onclick="showUserSection('myReports')">üìä My Reports</a></li>
                    <li><a href="#" onclick="showUserSection('submitReport')">üìù Submit Report</a></li>
                </ul>
            </aside>
            
            <main class="content">
                <!-- Profile Section -->
                <div id="profileSection" class="section active">
                    <div class="section-header">
                        <h2>My Profile</h2>
                        <button onclick="showEditProfileModal()" class="btn btn-primary">Edit Profile</button>
                    </div>
                    <div class="profile-card">
                        <div class="profile-avatar">üë§</div>
                        <div class="profile-info">
                            <h3 id="profileName">User Name</h3>
                            <p id="profileEmail">user@example.com</p>
                            <p id="profileRole">Member</p>
                            <p id="profilePhone">Phone: Not set</p>
                            <p id="profileDepartment">Department: Not set</p>
                        </div>
                    </div>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3 id="userActivitiesCount">0</h3>
                            <p>Activities Joined</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="userParticipationRate">0%</h3>
                            <p>Participation Rate</p>
                        </div>
                        <div class="stat-card">
                            <h3 id="userReportsSubmitted">0</h3>
                            <p>Reports Submitted</p>
                        </div>
                    </div>
                </div>

                <!-- My Activities Section -->
                <div id="myActivitiesSection" class="section">
                    <div class="section-header">
                        <h2>Available Activities</h2>
                    </div>
                    <div class="activities-grid" id="activitiesGrid"></div>
                </div>

                <!-- Participation Section -->
                <div id="participationSection" class="section">
                    <div class="section-header">
                        <h2>My Participation</h2>
                    </div>
                    <div class="table-container">
                        <table id="participationTable">
                            <thead>
                                <tr>
                                    <th>Activity</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Feedback</th>
                                </tr>
                            </thead>
                            <tbody id="participationTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <!-- My Reports Section -->
                <div id="myReportsSection" class="section">
                    <div class="section-header">
                        <h2>My Monthly Reports</h2>
                    </div>
                    <div class="report-content">
                        <div class="report-card">
                            <h3>This Month's Summary</h3>
                            <div id="userMonthlyReport"></div>
                        </div>
                        <div class="report-card">
                            <h3>Submitted Reports</h3>
                            <div id="userSubmittedReports"></div>
                        </div>
                    </div>
                </div>

                <!-- Submit Report Section -->
                <div id="submitReportSection" class="section">
                    <div class="section-header">
                        <h2>Submit Monthly Report</h2>
                    </div>
                    <div class="report-form-container">
                        <form id="monthlyReportForm">
                            <div class="form-group">
                                <label>Report Month</label>
                                <input type="month" id="reportMonth" required>
                            </div>
                            <div class="form-group">
                                <label>Activities Participated</label>
                                <textarea id="reportActivities" rows="3" placeholder="List activities you participated in..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Tasks Completed</label>
                                <textarea id="reportTasks" rows="3" placeholder="Describe tasks you completed..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Engagement Level (1-10)</label>
                                <input type="number" id="reportEngagement" min="1" max="10" required>
                            </div>
                            <div class="form-group">
                                <label>Achievements</label>
                                <textarea id="reportAchievements" rows="3" placeholder="List your achievements..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Challenges Faced</label>
                                <textarea id="reportChallenges" rows="3" placeholder="Describe any challenges..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label>Future Goals</label>
                                <textarea id="reportGoals" rows="3" placeholder="Your goals for next month..." required></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Submit Report</button>
                        </form>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Modals -->
    <div id="memberModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('memberModal')">&times;</span>
            <h2 id="memberModalTitle">Add Member</h2>
            <form id="memberForm">
                <input type="hidden" id="memberId">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="memberName" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="memberEmail" required>
                </div>
                <div class="form-group">
                    <label>Role</label>
                    <select id="memberRole" required>
                        <option value="Member">Member</option>
                        <option value="Coordinator">Coordinator</option>
                        <option value="Secretary">Secretary</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="memberStatus" required>
                        <option value="Active">Active</option>
                        <option value="Inactive">Inactive</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>

    <div id="activityModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('activityModal')">&times;</span>
            <h2 id="activityModalTitle">Add Activity</h2>
            <form id="activityForm">
                <input type="hidden" id="activityId">
                <div class="form-group">
                    <label>Activity Name</label>
                    <input type="text" id="activityName" required>
                </div>
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="activityDate" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="activityDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Status</label>
                    <select id="activityStatus" required>
                        <option value="Upcoming">Upcoming</option>
                        <option value="Completed">Completed</option>
                        <option value="Cancelled">Cancelled</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>

    <div id="transactionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('transactionModal')">&times;</span>
            <h2>Add Transaction</h2>
            <form id="transactionForm">
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" id="transactionDate" required>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <input type="text" id="transactionDescription" required>
                </div>
                <div class="form-group">
                    <label>Type</label>
                    <select id="transactionType" required>
                        <option value="Income">Income</option>
                        <option value="Expense">Expense</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Amount ($)</label>
                    <input type="number" id="transactionAmount" step="0.01" required>
                </div>
                <button type="submit" class="btn btn-primary">Save</button>
            </form>
        </div>
    </div>

    <div id="editProfileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editProfileModal')">&times;</span>
            <h2>Edit Profile</h2>
            <form id="editProfileForm">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" id="editProfileName" required>
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="editProfileEmail" required>
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="tel" id="editProfilePhone">
                </div>
                <div class="form-group">
                    <label>Department</label>
                    <input type="text" id="editProfileDepartment">
                </div>
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </form>
        </div>
    </div>

    <script>
// LocalStorage keys
const STORAGE_KEYS = {
  MEMBERS: 'society_members',
  ACTIVITIES: 'society_activities',
  TRANSACTIONS: 'society_transactions',
  USER_PARTICIPATION: 'society_user_participation',
  CURRENT_USER: 'society_current_user',
  USER_REPORTS: 'society_user_reports'
};

// Initialize data from localStorage or use defaults
let members = JSON.parse(localStorage.getItem(STORAGE_KEYS.MEMBERS)) || [
  { id: 1, name: 'M Ali', email: 'ali123@gmail.com', role: 'Member', status: 'Active', phone: '', department: '' },
  { id: 2, name: 'M Aslam', email: 'aslam123@gmail.com', role: 'Coordinator', status: 'Active', phone: '', department: '' }
];

let activities = JSON.parse(localStorage.getItem(STORAGE_KEYS.ACTIVITIES)) || [
  { id: 1, name: 'Tech Workshop', date: '2025-01-15', description: 'Web Development Workshop', status: 'Upcoming', participants: [] },
  { id: 2, name: 'Annual Meetup', date: '2025-01-20', description: 'Annual Society Gathering', status: 'Upcoming', participants: [] }
];

let transactions = JSON.parse(localStorage.getItem(STORAGE_KEYS.TRANSACTIONS)) || [
  { date: '2024-01-01', description: 'Membership Fees', type: 'Income', amount: 500 },
  { date: '2024-01-05', description: 'Event Expenses', type: 'Expense', amount: 200 }
];

let userParticipation = JSON.parse(localStorage.getItem(STORAGE_KEYS.USER_PARTICIPATION)) || [];
let userReports = JSON.parse(localStorage.getItem(STORAGE_KEYS.USER_REPORTS)) || [];
let currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER)) || null;

// Save data to localStorage
function saveToLocalStorage() {
  localStorage.setItem(STORAGE_KEYS.MEMBERS, JSON.stringify(members));
  localStorage.setItem(STORAGE_KEYS.ACTIVITIES, JSON.stringify(activities));
  localStorage.setItem(STORAGE_KEYS.TRANSACTIONS, JSON.stringify(transactions));
  localStorage.setItem(STORAGE_KEYS.USER_PARTICIPATION, JSON.stringify(userParticipation));
  localStorage.setItem(STORAGE_KEYS.USER_REPORTS, JSON.stringify(userReports));
}

function saveCurrentUser() {
  localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(currentUser));
}

// Check for existing session on page load
window.addEventListener('DOMContentLoaded', function() {
  if (currentUser) {
    if (currentUser.role === 'admin') {
      showPage('adminPage');
      loadAdminData();
    } else if (currentUser.role === 'user') {
      showPage('userPage');
      loadUserData();
    }
  }
});

// Login System
document.getElementById('loginForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const role = document.getElementById('roleSelect').value;
  const username = document.getElementById('username').value;
  const password = document.getElementById('password').value;
  
  if (role === 'admin' && username === 'admin' && password === 'admin123') {
    currentUser = { role: 'admin', name: 'Admin User' };
    saveCurrentUser();
    showPage('adminPage');
    loadAdminData();
  } else if (role === 'user' && username === 'user' && password === 'user123') {
    currentUser = { role: 'user', name: 'M Ali', email: 'ali123@gmail.com', id: 1 };
    saveCurrentUser();
    showPage('userPage');
    loadUserData();
  } else {
    alert('Invalid credentials!');
  }
});

function showPage(pageId) {
  document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
  document.getElementById(pageId).classList.add('active');
}

function logout() {
  currentUser = null;
  localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
  showPage('loginPage');
  document.getElementById('loginForm').reset();
}

// Admin Functions
function showAdminSection(section) {
  document.querySelectorAll('#adminPage .section').forEach(s => s.classList.remove('active'));
  document.getElementById(section + 'Section').classList.add('active');
  
  document.querySelectorAll('#adminPage .menu a').forEach(a => a.classList.remove('active'));
  event.target.classList.add('active');
  
  if (section === 'userReports') {
    loadUserReportsForAdmin();
  }
}

function loadAdminData() {
  loadMembers();
  loadActivities();
  loadFinance();
  updateAdminStats();
}

function updateAdminStats() {
  document.getElementById('totalMembers').textContent = members.length;
  document.getElementById('activeMembers').textContent = members.filter(m => m.status === 'Active').length;
  document.getElementById('totalActivities').textContent = activities.length;
  document.getElementById('upcomingActivities').textContent = activities.filter(a => a.status === 'Upcoming').length;
  
  const income = transactions.filter(t => t.type === 'Income').reduce((sum, t) => sum + t.amount, 0);
  const expense = transactions.filter(t => t.type === 'Expense').reduce((sum, t) => sum + t.amount, 0);
  
  document.getElementById('totalIncome').textContent = '$' + income;
  document.getElementById('totalExpense').textContent = '$' + expense;
  document.getElementById('balance').textContent = '$' + (income - expense);
}

// Members Management
function loadMembers() {
  const tbody = document.getElementById('membersTableBody');
  tbody.innerHTML = '';
  
  members.forEach(member => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${member.id}</td>
      <td>${member.name}</td>
      <td>${member.email}</td>
      <td>${member.role}</td>
      <td><span class="badge badge-${member.status.toLowerCase()}">${member.status}</span></td>
      <td>
        <button class="action-btn btn-edit" onclick="editMember(${member.id})">Edit</button>
        <button class="action-btn btn-delete" onclick="deleteMember(${member.id})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function showAddMemberModal() {
  document.getElementById('memberModalTitle').textContent = 'Add Member';
  document.getElementById('memberForm').reset();
  document.getElementById('memberId').value = '';
  document.getElementById('memberModal').classList.add('active');
}

function editMember(id) {
  const member = members.find(m => m.id === id);
  if (member) {
    document.getElementById('memberModalTitle').textContent = 'Edit Member';
    document.getElementById('memberId').value = member.id;
    document.getElementById('memberName').value = member.name;
    document.getElementById('memberEmail').value = member.email;
    document.getElementById('memberRole').value = member.role;
    document.getElementById('memberStatus').value = member.status;
    document.getElementById('memberModal').classList.add('active');
  }
}

function deleteMember(id) {
  if (confirm('Are you sure you want to delete this member?')) {
    members = members.filter(m => m.id !== id);
    saveToLocalStorage();
    loadMembers();
    updateAdminStats();
  }
}

document.getElementById('memberForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const id = document.getElementById('memberId').value;
  const memberData = {
    name: document.getElementById('memberName').value,
    email: document.getElementById('memberEmail').value,
    role: document.getElementById('memberRole').value,
    status: document.getElementById('memberStatus').value
  };
  
  if (id) {
    const index = members.findIndex(m => m.id === parseInt(id));
    members[index] = { ...members[index], ...memberData };
  } else {
    memberData.id = members.length > 0 ? Math.max(...members.map(m => m.id)) + 1 : 1;
    memberData.phone = '';
    memberData.department = '';
    members.push(memberData);
  }
  
  saveToLocalStorage();
  closeModal('memberModal');
  loadMembers();
  updateAdminStats();
});

// Activities Management
function loadActivities() {
  const tbody = document.getElementById('activitiesTableBody');
  tbody.innerHTML = '';
  
  activities.forEach(activity => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${activity.id}</td>
      <td>${activity.name}</td>
      <td>${activity.date}</td>
      <td>${activity.participants.length}</td>
      <td><span class="badge badge-${activity.status.toLowerCase()}">${activity.status}</span></td>
      <td>
        <button class="action-btn btn-edit" onclick="editActivity(${activity.id})">Edit</button>
        <button class="action-btn btn-delete" onclick="deleteActivity(${activity.id})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function showAddActivityModal() {
  document.getElementById('activityModalTitle').textContent = 'Add Activity';
  document.getElementById('activityForm').reset();
  document.getElementById('activityId').value = '';
  document.getElementById('activityModal').classList.add('active');
}

function editActivity(id) {
  const activity = activities.find(a => a.id === id);
  if (activity) {
    document.getElementById('activityModalTitle').textContent = 'Edit Activity';
    document.getElementById('activityId').value = activity.id;
    document.getElementById('activityName').value = activity.name;
    document.getElementById('activityDate').value = activity.date;
    document.getElementById('activityDescription').value = activity.description;
    document.getElementById('activityStatus').value = activity.status;
    document.getElementById('activityModal').classList.add('active');
  }
}

function deleteActivity(id) {
  if (confirm('Are you sure you want to delete this activity?')) {
    activities = activities.filter(a => a.id !== id);
    saveToLocalStorage();
    loadActivities();
    updateAdminStats();
  }
}

document.getElementById('activityForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const id = document.getElementById('activityId').value;
  const activityData = {
    name: document.getElementById('activityName').value,
    date: document.getElementById('activityDate').value,
    description: document.getElementById('activityDescription').value,
    status: document.getElementById('activityStatus').value
  };
  
  if (id) {
    const index = activities.findIndex(a => a.id === parseInt(id));
    activities[index] = { ...activities[index], ...activityData };
  } else {
    activityData.id = activities.length > 0 ? Math.max(...activities.map(a => a.id)) + 1 : 1;
    activityData.participants = [];
    activities.push(activityData);
  }
  
  saveToLocalStorage();
  closeModal('activityModal');
  loadActivities();
  updateAdminStats();
});

// Finance Management
function loadFinance() {
  const tbody = document.getElementById('financeTableBody');
  tbody.innerHTML = '';
  
  transactions.forEach((transaction, index) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${transaction.date}</td>
      <td>${transaction.description}</td>
      <td><span class="badge badge-${transaction.type.toLowerCase()}">${transaction.type}</span></td>
      <td>$${transaction.amount}</td>
      <td>
        <button class="action-btn btn-delete" onclick="deleteTransaction(${index})">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function showAddTransactionModal() {
  document.getElementById('transactionForm').reset();
  document.getElementById('transactionModal').classList.add('active');
}

function deleteTransaction(index) {
  if (confirm('Are you sure you want to delete this transaction?')) {
    transactions.splice(index, 1);
    saveToLocalStorage();
    loadFinance();
    updateAdminStats();
  }
}

document.getElementById('transactionForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const transactionData = {
    date: document.getElementById('transactionDate').value,
    description: document.getElementById('transactionDescription').value,
    type: document.getElementById('transactionType').value,
    amount: parseFloat(document.getElementById('transactionAmount').value)
  };
  
  transactions.push(transactionData);
  saveToLocalStorage();
  closeModal('transactionModal');
  loadFinance();
  updateAdminStats();
});

// Reports
function generateReport() {
  const memberReport = document.getElementById('memberActivityReport');
  memberReport.innerHTML = '';
  
  members.forEach(member => {
    const activityCount = userParticipation.filter(p => p.userId === member.id).length;
    const item = document.createElement('div');
    item.className = 'report-item';
    item.innerHTML = `
      <span>${member.name}</span>
      <span>${activityCount} activities</span>
    `;
    memberReport.appendChild(item);
  });
  
  const financialReport = document.getElementById('financialReport');
  const income = transactions.filter(t => t.type === 'Income').reduce((sum, t) => sum + t.amount, 0);
  const expense = transactions.filter(t => t.type === 'Expense').reduce((sum, t) => sum + t.amount, 0);
  
  financialReport.innerHTML = `
    <div class="report-item">
      <span>Total Income</span>
      <span style="color: #2ecc71;">$${income}</span>
    </div>
    <div class="report-item">
      <span>Total Expense</span>
      <span style="color: #e74c3c;">$${expense}</span>
    </div>
    <div class="report-item">
      <span>Net Balance</span>
      <span style="color: ${income - expense >= 0 ? '#2ecc71' : '#e74c3c'};">$${income - expense}</span>
    </div>
    <div class="report-item">
      <span>Total Transactions</span>
      <span>${transactions.length}</span>
    </div>
  `;
}

// Load User Reports for Admin
function loadUserReportsForAdmin() {
  const container = document.getElementById('userReportsContainer');
  container.innerHTML = '';
  
  if (userReports.length === 0) {
    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">No reports submitted yet.</p>';
    return;
  }
  
  userReports.forEach(report => {
    const member = members.find(m => m.id === report.userId);
    const card = document.createElement('div');
    card.className = 'user-report-card';
    card.innerHTML = `
      <h4>${member ? member.name : 'Unknown User'}</h4>
      <div class="report-meta">
        <span>üìÖ ${report.month}</span>
        <span>‚≠ê Engagement: ${report.engagement}/10</span>
      </div>
      <div class="report-section">
        <strong>Activities:</strong>
        <p>${report.activities}</p>
      </div>
      <div class="report-section">
        <strong>Tasks Completed:</strong>
        <p>${report.tasks}</p>
      </div>
      <div class="report-section">
        <strong>Achievements:</strong>
        <p>${report.achievements}</p>
      </div>
      <div class="report-section">
        <strong>Challenges:</strong>
        <p>${report.challenges}</p>
      </div>
      <div class="report-section">
        <strong>Future Goals:</strong>
        <p>${report.goals}</p>
      </div>
    `;
    container.appendChild(card);
  });
}

// User Functions
function showUserSection(section) {
  document.querySelectorAll('#userPage .section').forEach(s => s.classList.remove('active'));
  document.getElementById(section + 'Section').classList.add('active');
  
  document.querySelectorAll('#userPage .menu a').forEach(a => a.classList.remove('active'));
  event.target.classList.add('active');
  
  if (section === 'submitReport') {
    const now = new Date();
    const monthStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    document.getElementById('reportMonth').value = monthStr;
  }
}

function loadUserData() {
  loadUserProfile();
  loadUserActivities();
  loadUserParticipation();
  loadUserReport();
  loadUserSubmittedReports();
}

function loadUserProfile() {
  const member = members.find(m => m.id === currentUser.id);
  if (member) {
    document.getElementById('profileName').textContent = member.name;
    document.getElementById('profileEmail').textContent = member.email;
    document.getElementById('profileRole').textContent = member.role;
    document.getElementById('profilePhone').textContent = 'Phone: ' + (member.phone || 'Not set');
    document.getElementById('profileDepartment').textContent = 'Department: ' + (member.department || 'Not set');
  }
  
  const userActivities = userParticipation.filter(p => p.userId === currentUser.id);
  document.getElementById('userActivitiesCount').textContent = userActivities.length;
  
  const participationRate = activities.length > 0 ? Math.round((userActivities.length / activities.length) * 100) : 0;
  document.getElementById('userParticipationRate').textContent = participationRate + '%';
  
  const reportsCount = userReports.filter(r => r.userId === currentUser.id).length;
  document.getElementById('userReportsSubmitted').textContent = reportsCount;
}

function loadUserActivities() {
  const grid = document.getElementById('activitiesGrid');
  grid.innerHTML = '';
  
  activities.forEach(activity => {
    const isJoined = activity.participants.includes(currentUser.id);
    const card = document.createElement('div');
    card.className = 'activity-card';
    card.innerHTML = `
      <h3>${activity.name}</h3>
      <p>üìÖ ${activity.date}</p>
      <p>${activity.description}</p>
      <p><span class="badge badge-${activity.status.toLowerCase()}">${activity.status}</span></p>
      <button class="btn ${isJoined ? 'btn-logout' : 'btn-join'}" 
              onclick="${isJoined ? 'leaveActivity' : 'joinActivity'}(${activity.id})">
        ${isJoined ? 'Leave' : 'Join'}
      </button>
    `;
    grid.appendChild(card);
  });
}

function joinActivity(activityId) {
  const activity = activities.find(a => a.id === activityId);
  if (activity && !activity.participants.includes(currentUser.id)) {
    activity.participants.push(currentUser.id);
    userParticipation.push({
      userId: currentUser.id,
      activityId: activityId,
      activityName: activity.name,
      date: activity.date,
      status: 'Joined',
      feedback: ''
    });
    saveToLocalStorage();
    loadUserActivities();
    loadUserProfile();
    loadUserParticipation();
  }
}

function leaveActivity(activityId) {
  const activity = activities.find(a => a.id === activityId);
  if (activity) {
    activity.participants = activity.participants.filter(id => id !== currentUser.id);
    userParticipation = userParticipation.filter(p => !(p.userId === currentUser.id && p.activityId === activityId));
    saveToLocalStorage();
    loadUserActivities();
    loadUserProfile();
    loadUserParticipation();
  }
}

function loadUserParticipation() {
  const tbody = document.getElementById('participationTableBody');
  tbody.innerHTML = '';
  
  const userActivities = userParticipation.filter(p => p.userId === currentUser.id);
  
  if (userActivities.length === 0) {
    tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #666;">No activities joined yet</td></tr>';
    return;
  }
  
  userActivities.forEach(participation => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${participation.activityName}</td>
      <td>${participation.date}</td>
      <td><span class="badge badge-active">${participation.status}</span></td>
      <td>${participation.feedback || 'No feedback yet'}</td>
    `;
    tbody.appendChild(tr);
  });
}

function loadUserReport() {
  const reportDiv = document.getElementById('userMonthlyReport');
  const userActivities = userParticipation.filter(p => p.userId === currentUser.id);
  
  const currentMonth = new Date().getMonth();
  const monthlyActivities = userActivities.filter(p => {
    const activityMonth = new Date(p.date).getMonth();
    return activityMonth === currentMonth;
  });
  
  reportDiv.innerHTML = `
    <div class="report-item">
      <span>Activities This Month</span>
      <span>${monthlyActivities.length}</span>
    </div>
    <div class="report-item">
      <span>Total Activities</span>
      <span>${userActivities.length}</span>
    </div>
    <div class="report-item">
      <span>Participation Rate</span>
      <span>${activities.length > 0 ? Math.round((userActivities.length / activities.length) * 100) : 0}%</span>
    </div>
    <div class="report-item">
      <span>Status</span>
      <span style="color: #2ecc71;">Active Member</span>
    </div>
  `;
}

function loadUserSubmittedReports() {
  const reportDiv = document.getElementById('userSubmittedReports');
  const myReports = userReports.filter(r => r.userId === currentUser.id);
  
  if (myReports.length === 0) {
    reportDiv.innerHTML = '<p style="color: #666; text-align: center; padding: 20px;">No reports submitted yet</p>';
    return;
  }
  
  reportDiv.innerHTML = '';
  myReports.forEach(report => {
    const item = document.createElement('div');
    item.className = 'report-item';
    item.innerHTML = `
      <span>üìÖ ${report.month}</span>
      <span>‚≠ê ${report.engagement}/10</span>
    `;
    reportDiv.appendChild(item);
  });
}

// Edit Profile
function showEditProfileModal() {
  const member = members.find(m => m.id === currentUser.id);
  if (member) {
    document.getElementById('editProfileName').value = member.name;
    document.getElementById('editProfileEmail').value = member.email;
    document.getElementById('editProfilePhone').value = member.phone || '';
    document.getElementById('editProfileDepartment').value = member.department || '';
    document.getElementById('editProfileModal').classList.add('active');
  }
}

document.getElementById('editProfileForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const member = members.find(m => m.id === currentUser.id);
  if (member) {
    member.name = document.getElementById('editProfileName').value;
    member.email = document.getElementById('editProfileEmail').value;
    member.phone = document.getElementById('editProfilePhone').value;
    member.department = document.getElementById('editProfileDepartment').value;
    
    currentUser.name = member.name;
    currentUser.email = member.email;
    
    saveToLocalStorage();
    saveCurrentUser();
    closeModal('editProfileModal');
    loadUserProfile();
    alert('Profile updated successfully!');
  }
});

// Submit Monthly Report
document.getElementById('monthlyReportForm').addEventListener('submit', function(e) {
  e.preventDefault();
  
  const reportData = {
    userId: currentUser.id,
    month: document.getElementById('reportMonth').value,
    activities: document.getElementById('reportActivities').value,
    tasks: document.getElementById('reportTasks').value,
    engagement: parseInt(document.getElementById('reportEngagement').value),
    achievements: document.getElementById('reportAchievements').value,
    challenges: document.getElementById('reportChallenges').value,
    goals: document.getElementById('reportGoals').value,
    submittedAt: new Date().toISOString()
  };
  
  const existingIndex = userReports.findIndex(r => r.userId === currentUser.id && r.month === reportData.month);
  
  if (existingIndex >= 0) {
    if (confirm('A report for this month already exists. Do you want to update it?')) {
      userReports[existingIndex] = reportData;
    } else {
      return;
    }
  } else {
    userReports.push(reportData);
  }
  
  saveToLocalStorage();
  document.getElementById('monthlyReportForm').reset();
  loadUserProfile();
  loadUserSubmittedReports();
  alert('Report submitted successfully!');
});

// Modal Functions
function closeModal(modalId) {
  document.getElementById(modalId).classList.remove('active');
}

window.onclick = function(event) {
  if (event.target.classList.contains('modal')) {
    event.target.classList.remove('active');
  }
}
    </script>
</body>
</html>